{
    "contents" : "library(ggplot2)\nlibrary(lubridate)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(scales)\nsource(\"R/multiplot.r\")\nload(\"data/harvest_survey.rda\")\nload(\"data/sonar.rda\")\nload(\"data/test_fish.rda\")\n\nyear(harvest_survey$date) <- 2013\n\nlimits <- aes(ymax = harvest_survey$Mean + harvest_survey$SE, \n              ymin = harvest_survey$Mean - harvest_survey$SE)\n\nggplot(data = harvest_survey, aes(x = date, y = Mean)) + geom_point(stat= \"identity\", fill = \"white\", color = \"black\") + geom_line() +\n    geom_errorbar(limits,  color = \"red\") +  facet_wrap(~ year) +\n    labs(title = \"Harvest Survey Results Across Years\", \n         x = \"Date\", \n         y = \"Mean\") \n\nyear(harvest_survey$date) <- harvest_survey$year\n\ntest_fish<- test_fish[!test_fish$index >= 400,]\ntest_fish <-test_fish[!test_fish$station == \".\",]\ntest_fish <-test_fish[!is.na(test_fish$year),]\n\nyear(test_fish$date) <- 2013\n\nggplot(data = test_fish, aes(x = date,  y = index, fill = station)) + geom_bar(stat = \"identity\") +\n    facet_wrap(~ year) \n\nyear(test_fish$date) <- test_fish$year\n\nyear(sonar$date) <- 2013\n\nggplot(data = sonar, aes(x = date, y = n)) + geom_line(stat = \"identity\", fill = \"white\", color = \"black\") +\n    facet_wrap(~ year) +\n    labs(title = \"Sonar Count Results Across Years\", \n         x = \"Date\", \n         y = \"Sockeye Counted\") \n\nyear(sonar$date) <- sonar$year\n\n\nharv_surv_tmp <- harvest_survey\n\np_values <- data.frame(days_lagged = numeric(), model_type = numeric(), intercept = numeric(), parameter = numeric())\n\n## NO STAGGER\np0<- ggplot(data = inner_join(sonar, harv_surv_tmp, by = \"date\"), aes(x = n, y = Mean)) + geom_point() +\n    labs(title = \"No Staggering\", \n         x = \"Sonar Count\", \n         y = \"Mean Harvest\") +\n    scale_x_continuous(breaks=pretty_breaks(n=3)) \np_values[1,] <- c(0,\"log\",summary(lm(inner_join(sonar, harv_surv_tmp, by = \"date\")$Mean ~ log(inner_join(sonar, harv_surv_tmp, by = \"date\")$n)))$coefficients[,4])\np_values[2,] <- c(0,\"linear\",summary(lm(inner_join(sonar, harv_surv_tmp, by = \"date\")$Mean ~ inner_join(sonar, harv_surv_tmp, by = \"date\")$n))$coefficients[,4])\n\n## ONE DAY STAGGER\nday(harv_surv_tmp$date) <- day(harv_surv_tmp$date) + 1\np1 <- ggplot(data = inner_join(sonar, harv_surv_tmp, by = \"date\"), aes(x = n, y = Mean)) + geom_point() +\n    labs(title = \"Staggered One Day\", \n         x = \"Sonar Count\", \n         y = \"Mean Harvest\") +\n    scale_x_continuous(breaks=pretty_breaks(n=3)) \np1_best <- ggplot(data = inner_join(sonar, harv_surv_tmp, by = \"date\"), aes(x = n, y = Mean)) + geom_point() +\n    labs(title = \"Sonar Counts By Mean Catch - Staggered For One Day\", \n         x = \"Sonar Count\", \n         y = \"Mean Harvest\") + \n    stat_smooth(formula = \"y ~ log(x)\", method = \"lm\")\np_values[3,] <- c(1,\"log\",summary(lm(inner_join(sonar, harv_surv_tmp, by = \"date\")$Mean ~ log(inner_join(sonar, harv_surv_tmp, by = \"date\")$n)))$coefficients[,4])\np_values[4,] <- c(1,\"linear\",summary(lm(inner_join(sonar, harv_surv_tmp, by = \"date\")$Mean ~ inner_join(sonar, harv_surv_tmp, by = \"date\")$n))$coefficients[,4])\n\n## TWO DAY STAGGER\nday(harv_surv_tmp$date) <- day(harv_surv_tmp$date) + 1\np2 <- ggplot(data = inner_join(sonar, harv_surv_tmp, by = \"date\"), aes(x = n, y = Mean)) + geom_point() +\n    labs(title = \"Staggered Two Days\", \n         x = \"Sonar Count\", \n         y = \"Mean Harvest\") +\n    scale_x_continuous(breaks=pretty_breaks(n=3)) \np_values[5,] <- c(2,\"log\",summary(lm(inner_join(sonar, harv_surv_tmp, by = \"date\")$Mean ~ log(inner_join(sonar, harv_surv_tmp, by = \"date\")$n)))$coefficients[,4])\np_values[6,] <- c(2,\"linear\",summary(lm(inner_join(sonar, harv_surv_tmp, by = \"date\")$Mean ~ inner_join(sonar, harv_surv_tmp, by = \"date\")$n))$coefficients[,4])\n\n## THREE DAY STAGGER\nday(harv_surv_tmp$date) <- day(harv_surv_tmp$date) + 1\np3<- ggplot(data = inner_join(sonar, harv_surv_tmp, by = \"date\"), aes(x = n, y = Mean)) + geom_point() +\n    labs(title = \"Staggered Three Days\", \n         x = \"Sonar Count\", \n         y = \"Mean Harvest\") +\n    scale_x_continuous(breaks=pretty_breaks(n=3)) \np_values[7,] <- c(3,\"log\",summary(lm(inner_join(sonar, harv_surv_tmp, by = \"date\")$Mean ~ log(inner_join(sonar, harv_surv_tmp, by = \"date\")$n)))$coefficients[,4])\np_values[8,] <- c(3,\"linear\",summary(lm(inner_join(sonar, harv_surv_tmp, by = \"date\")$Mean ~ inner_join(sonar, harv_surv_tmp, by = \"date\")$n))$coefficients[,4])\n\n## FOUR DAY STAGGER\nday(harv_surv_tmp$date) <- day(harv_surv_tmp$date) + 1\np4 <- ggplot(data = inner_join(sonar, harv_surv_tmp, by = \"date\"), aes(x = n, y = Mean)) + geom_point() +\n    labs(title = \"Staggered Four Days\", \n         x = \"Sonar Count\", \n         y = \"Mean Harvest\") +\n    scale_x_continuous(breaks=pretty_breaks(n=3)) \n\np_values[9,] <- c(4,\"log\",summary(lm(inner_join(sonar, harv_surv_tmp, by = \"date\")$Mean ~ log(inner_join(sonar, harv_surv_tmp, by = \"date\")$n)))$coefficients[,4])\np_values[10,] <- c(4,\"linear\",summary(lm(inner_join(sonar, harv_surv_tmp, by = \"date\")$Mean ~ inner_join(sonar, harv_surv_tmp, by = \"date\")$n))$coefficients[,4])\n\n\np_values <- gather(p_values, days_lagged, model_type)\ncolnames(p_values)[3] <- \"value\"\ncolnames(p_values)[4] <- \"p\"\np_values$p <- as.numeric(p_values$p)\n\nggplot(data = p_values, aes(y = -log(p), x = days_lagged)) + geom_bar(stat = \"identity\") +\n    facet_wrap(value ~ model_type) + \n    labs(title = \"Negative Log Of Parameter P-Values\", \n         x = \"Days Lagged Of Harvest Survey\", \n         y = \"-log(p value)\")\n\nmultiplot(p0, p1, p2, p3, p4, cols=3)\n\n\n\np_values <- data.frame(days_lagged = numeric(), model_type = numeric(), intercept = numeric(), parameter = numeric())\nplot_list_obj <- list()\n\n\nfor(i in 0:50) {\n    plotting_obj <- inner_join(test_fish, sonar, by = \"date\")\n    plot_list_obj[[i+1]] <- ggplot( data = plotting_obj, aes(x = log(n), y = index, color)) + geom_point() +\n        facet_wrap( ~ station) + labs(title = paste(\"Staggered\", i, \"Days\"), \n                                      x = \"Offshore Catch Index\", \n                                      y = \"log(Sonar Count)\") \n    p_values[i+1,] <- c(i,\"log\",summary(lm(plotting_obj$index ~ log(plotting_obj$n)))$coefficients[,4])\n    \n    day(test_fish$date) <- day(test_fish$date) + 1 \n}\n\n\np_values <- gather(p_values, days_lagged, model_type)\ncolnames(p_values)[3] <- \"value\"\ncolnames(p_values)[4] <- \"p\"\np_values$p <- as.numeric(p_values$p)\np_values$days_lagged <- as.numeric(p_values$days_lagged)\n\n\nggplot(data = p_values, aes(y = -log(p), x = days_lagged)) + geom_bar(stat = \"identity\") +\n    facet_wrap( ~ value) + \n    labs(title = \"Negative Log Of Parameter P-Values\", \n         x = \"Days Lagged Of Offshore Test Fishing\", \n         y = \"-log(p value)\")",
    "created" : 1419358016873.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1143181747",
    "id" : "29F79165",
    "lastKnownWriteTime" : 1419639738,
    "path" : "C:/Users/chthompson/Desktop/kenai_dip_net/analysis.R",
    "project_path" : "analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}